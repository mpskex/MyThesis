\chapter{多人人体姿态估计}
\label{cha:related}
本章主要根据网络设计中涉及到领域进行了相关工作的整理与综述。多人姿态估计主要涉及了目标检测、实例分割、单人姿态估计等计算机视觉中常见的相关任务。本文就从对这三个以及多人姿态估计任务的近年研究展开，对多人姿态估计整体的相关工作进行论述。
\section{目标检测}
\label{sec:detect}
目标检测的目标是给出尽可能准确的目标边界框。近年来，由于其突出的鲁棒性、泛化性，基于深度学习的目标检测方法已经成为了研究者们关注的主要方向。在本节，文章主要将按照目标检测发展顺序来总结每个类别下的典型方法。
\subsection{两阶段目标检测方法}
\label{2stagedetector}
两阶段目标检测方法的起始是区域卷积神经网络(R-CNN)\cite{Girshick_2014_CVPR}。R-CNN提出了使用并行的卷积神经网络分支来得到图中不同位置分类结果，最后组织出一个稠密的分类结果图，通过对结果图的分析能够得到不同类别物体的位置。最后经过后处理，去掉每个类别置信度底的边界框并使用非极大值抑制去掉高度重合的边界框，就可以得到准确的检测结果。虽然R-CNN并没有完全给出一个端到端的方法，但是这个工作引出了后面常见的两阶段目标检测方法。

Girshick R.等人在R-CNN的设计中，使用了滑动窗口对图像的每个区域进行分类，并且这些滑动窗口的数目过于庞大。为了减少区域的数量，Faster R-CNN\cite{Ren2015Faster}提出了使用区域建议网络来给为后面的分类分支提供较精确的候选框，供兴趣区域池化层裁剪特征，以便得到最终回归的检测框。两阶段目标检测方法准确度相对更高一些，由于区域建议网络已经给出了粗略的位置信息，并较为贪婪地选取不同尺寸、不同长宽比的候选框，所以其在召回率上会有一定的优势。

\subsection{单阶段目标检测方法}
\label{subsec:1stagedetector}
Redmon J.\cite{redmon2016you}等人的工作，也就是YOLO的出现标志着单阶段目标检测方法的出现。网络主要的思路就是使用全卷积的方式直接对于每个位置进行区域位置的分类与检测框回归。这样的可以省去两阶段的中冗余的区域建议网络的计算以及可能会损失精度的池化层。在速度上，但阶段目标检测也显示出了相当的优势。

为了改善YOLO中出现的漏检问题，Liu W.等人提出了SSD\cite{liu2016ssd}，也就是一种单次预测多边界框的检测器。SSD通过从不同感受野尺寸中回归不同大小的边界框来弥补单阶段检测方法中出现的漏检问题。因为对于较大物体的检测，网络需要更大的感受野区域去寻找物体局部特征在物体全局的关系；另外小物体检测中需要较为精细的候选框密度，也就是用来做检测的特征图的尺寸要尽可能大才能保证小物体的检测召回率维持在可接受的范围内。

\subsection{实例分割}
\label{subsec:insseg}
实际上实例分割是目标检测的一个延伸任务。最直观的完成实例分割的方法就是在完成目标检测后使用池化层，将特征输入进分割子网中，求得最终的实例分割结果。正如Kaiming H.\cite{He2017Mask}的工作中提到的，使用简单的分割子网就能够比较好地完成实例分割的任务。目前不借助检测结果得到实例分割的方法并不流行，因为寻找同类中不同物体的分割边界对于全卷积网络而言还是有挑战性的，除非能够寻找一种合适的表达来描述不同物体的标记。

\section{注意力机制与目标检测}
\label{sec:attenandobjdet}
注意力机制不光可以被应用于自然语言处理领域，也可以被应用在计算机视觉领域，比如Mnih V.等人的工作\cite{mnih2014recurrent}。该方法使用了循环神经网络的结构，动态地生成下一步网络需要关注的对应区域的注意力，让网络获得每次关注特定区域的能力。

在Vaswani A.等人的工作\cite{vaswani2017attention}之后，非循环网络结构下的自生成软注意力也越来越多地被应用在不同领域中。近年来，研究者把注意力机制应用在目标检测任务上，比如Fei W.等人的工作\cite{wang2017residual}，使用了并行的分支生成注意力\footnote{Fei W.等人的工作提出了三种注意力的形式，分别是空间注意力、通道注意力以及混合注意力。其中混合注意力是前两者的混合形式。}，并与特征融合从而优化分类的结果。

\section{姿态估计}
\label{sec:poseestimation}
姿态估计任务一直在计算机视觉领域拥有较高的关注度。尤其是在神经网络出现之后，姿态估计问题终于有了较为稳定且性能良好的解决方法。在本节中，文章将从单人姿态估计与多人姿态估计两个方向展开，总结近年来计算机视觉领域在姿态估计任务上的相关工作。
\subsection{单人人体姿态估计}
\label{subsec:singlepose}
在单人姿态估计方法中，传统计算机视觉的方法虽然相对而言时间较为久远，但是仍然能提供比较好的解决思路，因此在这里本文也在本节总结其对姿态估计的贡献。近年来基于深度学习的方法如雨后春笋般出现，我们也挑选了其中在单人人体姿态估计中较为典型的几个工作作为综述的内容。
\subsubsection{基于传统计算机视觉方法的人体姿态估计方法}
\label{subsubsec:legacypose}
基于传统计算机视觉方法的人体姿态估计中最有代表性的就是DPM\cite{felzenszwalb2010object}，也就是基于混合多尺度的可变形部件模型。该工作中使用的图结构依赖一系列部件以及部件间的位置关系来表示目标。每个部件描述目标的一个局部属性，通过部件间的弹簧连接表示模型的可变形配置。网络使用高斯金字塔提取图像中的特征，以这些特征作为依据使用隐式支持向量机\footnote{隐式支持向量机，Latent Support Vector Machine}回归最终人体不同部件的位置。这个工作的典型特征，也是一般多数基于传统计算机视觉方法的人体姿态估计使用的技巧，就是利用图模型给人体姿态建立先验，使用这一部分先验来帮助算法得到人体姿态估计结果。
\subsubsection{基于深度学习的人体姿态估计方法}
\label{subsubsec:deeppose}
基于深度学习的人体姿态估计方法的典型是卷积姿态网络(CPM)\cite{wei2016convolutional}。CPM有两个主要的贡献：隐式地让网络学习人体姿态中不同关键点地信息，而不需要使用任何先验去约束或推断关键点信息；提出了中继监督和多阶段网络设计，并且强调了感受野对姿态估计地重要性。其中中继监督与多阶段的网络设计在之后很多的基于深度学习的姿态估计方法中都有体现。其中堆叠沙漏网络(SHN)\cite{newell2016stacked}就是一个较为典型的例子。SHN提出了沙漏结构，一定程度上融合了不同尺度的特征，让网络能够得到更加精细的关键点估计结果。SHN也一样将沙漏架构堆叠起来，形成一个多阶段的结构，并同样引入中继监督，来避免其过深的网络带来的梯度消失的问题。

由于SHN的特征融合的确较好地提高了模型的准确度，因此之后的工作都大多从特征融合这个方向来改进方法。其中比较典型的就是级联金字塔网络(CPN)\cite{Chen2017Cascaded}。CPN提出如果希望得到更好的关键点结果，那么就必须从不同尺度的特征入手。CPN使用了来自所有尺度的特征，并使用双线性插值上采样的方法一并放大至最底层特征图的大小。这些特征直接被合并在一起，放入优化网络得到最终的特征点热图。这样的方法极大地改善了网络的准确度，然而带来的就是庞大的参数量与计算量。这个方法不论是从训练还是预测角度来讲，都是难以操作的。但是毋庸置疑的是，CPN在解决姿态估计任务提供了一个明确的方向，如果能提出更高效的特征融合方法，那么就有可能在姿态估计任务上获得更好的效果。

\subsection{多人姿态估计}
\label{subsubsec:multipose}
多人姿态估计方法可以分为自顶向下与自底向上两种类型。自顶向下的多人姿态估计方法的主要特点就是在得到人体目标位置的前提下去预测人体姿态；而自底向上的方法特点就是先完整的预测人体姿态，再讲零散的姿态信息根据特征或其他的表达重组，建立独立完整的人体姿态。
\subsubsection{自顶向下的多人姿态估计方法}
\label{subsubsec:topdownpose}
目前常见的多人姿态估计方法主要都是使用自顶向下的格局设计网络的，也就是说，算法会先提取人体位置，接下来经过裁剪以后送入姿态估计网络中得到姿态估计。这样的方法可以借助于高性能的单人姿态估计网络和人体检测网络来快速获得满意的效果。在近年改善自顶向下的多人姿态估计方法的工作中，F. Hao-Shu等人提出的区域多人姿态估计方法简写作RMPE\cite{fang2017rmpe}改善了以往自顶向下方法中目标检测不精确结果对于姿态估计的负面影响，通过设计简单的对称的空间变换网络\footnote{对称的空间变换网络，Symmetric Spatial Transformation Network，简称SSTN}来动态生成空间变换的参数，也就是人体检测结果来优化人体边界框与人体姿态估计的结果。这一点给原来看似简单的自顶向下多人姿态估计方法提供了新的改善思路。

\subsubsection{自底向上的多人姿态估计方法}
\label{subsubsec:bottomuppose}
在自底向上的方法中，OpenPose\cite{Cao2016Realtime}是十分典型的方法。OpenPose在之前CPM工作的基础上，额外增加了一个类似的分支用来回归向量场。这个向量场用来连接不同关键点。每一个关系使用一对稠密张量来描述对应的热图上每个位置的向量方向。虽然在稠密张量上求解向量与额外的网络分支的负担在计算复杂度体现出来，但是总体而言整个方法为我们用卷积网络完成自底向上的方法给出了很好的引导。

%	TODO: bookmark in chapter 02
另外除了回归向量寻找关键点之间的关系以外，Newell A.\cite{Newell2017Associative}等人的工作又提出了一种新的自底向上的多人姿态估计方法。文章中提出了使用关联编码(Associative Embedding)来让网络自身学习给关键点打标签。网络通过生成一组编码来标记关键点所属的人的标签。这给设计自底向上的多人姿态估计方法又提供了新的思路。


\section{本章小结}
本章总结了目标检测的现代算法，简单分析了两阶段与单阶段目标检测的特性，并且介绍了实例分割\ref{sec:detect}。在之后的一节中\ref{sec:attenandobjdet}本文简单介绍了注意力在目标检测的应用，以及这些方法使用注意力机制的主要思路。在最后一节\ref{sec:poseestimation}本文总结了现有的姿态估计方法以及他们对于该任务的贡献。
