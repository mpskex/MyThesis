\chapter{绪 论}
\label{cha:intro}

% 课题引言

\section{研究背景}
\label{sec:generalbackground}
人体姿态是计算机视觉领域中一个在现实场景中有极其重大意义的课题方向。一旦掌握了识别人体姿态的能力，计算机可以在各种与人有关的互动中扮演更为重要的角色。近年来，人体姿态估计不光在工业环境应用广泛，在商业上也表现出相当突出的尽头。在自动驾驶中，行人行为的预判是对驾驶决策相当重要，能够降低自动驾驶车辆与行人发生碰撞的可能性；在医疗康复中，姿态估计可以帮助医疗机构监督病人状态，防止出现跌倒的情况；在运动训练中，姿态估计可以被用于动作矫正系统，用来监督运动员的姿态标准性以及检验训练的有效性；在安防方面，行人姿态跟踪与步态识别对于我们追踪与分析潜在犯罪嫌疑人也有一定的帮助；在商业娱乐下，姿态信息也是人机交互的重要接口，在此方面的应用更是数不胜数。因此，寻找一个性能高，应用广的姿态估计方法对于计算机视觉领域是一个志在必得的目标，这也是近年来学界一直关注的焦点课题之一。

目前来讲，基于光学的姿态采集与追踪设备已经是一个非常成熟的技术。然而，所有使用非可见光的姿态采集设备都需要采集者设置多个标定好的特殊摄像机，例如高帧率红外摄像机，在封闭的室内场景中，对被采集者身上的光学追踪点进行定位。由于其捕捉人数有限，环境配置成本较高且需要被采集这佩戴跟踪点的原因，限制其只能应用于计算机渲染动画中。而如果姿态信息能在更加开放的环境被捕捉到，例如一台任意内参\footnote{相机的内参是相机横纵轴的焦距以及光心偏移}、任意外参\footnote{相机的外参是相机的位置姿态，通常是以一个六自由度的矩阵描述。}的，架设在室外场景的单目图像采集设备，不光可以拓宽该技术的应用场景，还可以大大降低该技术的成本，成为一种能够一般企业甚至个人负担起的技术。从2012年的AlexNet\cite{alex2012alexnet}开始兴起的深度学习和卷积神经网络热潮，让这种假设逐渐变成了现实。通过正确的表达，卷积神经网络可以完成在对于任意图像的人体姿态估计。

近年来基于深度学习的人体姿态估计方法层出不穷，从2014年的DeepPose\cite{toshev2014deeppose}到2018年的PersonLab\cite{Papandreou2018PersonLab}，可以看到学界对于这个问题的解决思路基本趋于一致：多阶段网络堆叠与中继监督方法结合来设计网络。对于人体姿态的表达也逐渐趋同：使用一组描述人体关键点位置的热图来表示网络最终给出的预测结果。总而言之，现有的人体姿态估计方法都是将姿态信息用关键点的形式表现以后，将回归关键点的任务化为回归关键点的位置概率图的方法。

在多人姿态估计方面，近年来出现的方法可以主要分为两大类：自顶向下，先定位目标位置再预测关键点位置，例如区域多人姿态估计\cite{fang2017rmpe}和自底向上，先预测所有的关键点位置，再使用关键点关系重建单人姿态，例如OpenPose\cite{Cao2016Realtime}。然而这两种方法都有相应的缺点，对于自顶向下的方法而言，一个精确的检测结果是非常重要的：如果检测结果有些许的偏移，那么也许就会漏掉一些目标的部分，这对于后面的关键点回归是一个灾难性的后果。同时，对于自底向上的方法，如何表达一个容易回归，鲁棒的关键点之间的关系也存在一定的难度，因此现有的自底向上都会在一些极端情况中因为结果不够鲁棒而导致重组关键点的结果出现异常\footnote{这些极端情况指，一些躯干相近的预测，如果躯干的朝向相近或边缘模糊，这些方法都会难以给出准确的关系预测，尤其是对于使用向量场表达关系的方法。}。

\section{研究目的}
\label{sec:generalmotivation}
由于现有算法都难以胜任实时场景的部署，为了算法性能的更好表现，网络还应该简化冗余的网络结构，让计算复杂度与空间复杂度在较小的开销小，尽可能好地完成这个任务。同时为了解决上文提到的两种困难，本文希望借鉴自顶向下与自底向上方法的优势，设计出一种网络结构，能够一定程度上解决他们各自存在的劣势。这个方法应该能够利用比较鲁棒的线索，将检测到的关键点重组为完整的骨架。

随着方法精度的不断上升，很多工作的侧重方向开始向优化计算复杂度靠拢。确实，现在的很多应用场景对使用深度学习的方法寄予了厚望，然而其巨大的计算开销让很多公司难以将其实际用于个人业务。为了降低计算成本，并充分利用好深度学习良好的灵活性，我们希望能通过减少网络计算量来让该算法获得更多地可能性。

为了降低网络计算与存储带来的开销，方法需要注意减少网络结构的冗余。对于自顶向下的方法而言，像区域姿态网络\cite{fang2017rmpe}，需要一个独立的目标检测网络来完成人体边界框的提取，同时在姿态提取阶段，一个相似的深度网络也是必须的：网络需要获得更深的结构来获得更好地结果。那么这一部分相似的深度网络结构是冗余的，我们完全可以通过简单线性组合来重新组织各个层次的特征来获得等价的效果。而且对于两个相似的任务，就例如本文中希望利用的实例分割与最终目标多人姿态估计，共享参数层可能会获得更好的效果，因此我们也希望能够在网络上利用共享的特征提取方法来达成这个目标。

在多人姿态检测中，目标检测被广泛应用，然而我们使用的信息一般都是检测到的边界框，并没有把目光放在实例分割上。实例分割与语义分割任务不同，其目标是将图像中出现的所有可描述的物体都分别勾勒出来，也就是说，它能够将每个目标的轮廓回归出来并给出分类。所以，即便在他们相互距离很近，甚至是遮挡的情况下，实例分割仍能够清晰地勾勒出单个人体的轮廓。同时需要提出的一点就是，实例分割与姿态估计是一对相关的任务：实例分割如果直接作用于多人姿态估计结果上可以增强姿态估计的结果；同样地，根据多人姿态估计的结果可以重建躯干的连接，这些连接是可以重新还原一个简单粗略的实例分割结果的。那么在这样一个前提下，我们可以尝试融合实例分割与姿态估计以让其互相促进，获得比仅使用边界框信息的方法更好的结果。


\section{研究内容}
\label{sec:generalfield}
本文的研究内容主要可以分为两个，其一为简化网络结构，提高网络的计算性能；其二为提出一种可以融合实例分割的多人姿态提取方法，并验证其性能。

近年来，学界对于迁移学习的研究也越来越深入，已经有工作证明了在训练自己网络的时候使用在较大数据集的分类任务下预训练好参数作为初始状态会获得更好的效果\cite{mishkin2015all}。并且，在Misra, Ishan等人\cite{misra2016cross}的工作中，也提出了对于相近网络中使用共享的参数会给网络带来额外的性能提升。在现有的多人姿态检测方法中，尤其是自顶向下的方法，会使用人体检测网络与姿态提取网络。而这些网络都依赖深层卷积网络来获得足够的感受野，所以不论是监测网络还是姿态网络，都需要一个相似甚至相同的的结构，使用预训练好的参数进行迁移训练，比如在ImageNet\cite{deng2009imagenet}下预训练好VGG-19\cite{simonyan2014very}或者ResNet-101\cite{He2015Deep}。一个很自然的思路就是通过使用共享的特征提取网络来以预训练好的参数作为初始训练一个多任务的网络，同时能够完成实例分割与姿态估计。这样的方法自然就是能够减少网络计算冗余，并且还会获得一定的性能提升。

正如章节\ref{sec:generalmotivation}所讲，我们希望融合实例分割的结果来完成对不同人的区域的区分。不论是语义分割还是实例分割任务，从他们的监督来讲，它们的真值都具有相当强的语义性，这也就意味着系统具有相当的鲁棒性。然而正因为如此，我们如果将实例分割直接用作重组关键点的信息，那么在真值被遮挡的部分是无法被考虑进去的。那么我们如何寻找一个对于人体轮廓更加宽松的，并且更鲁棒的表达呢？

% weakly supervised attention
我们借鉴了弱监督的思想，结合注意力机制的概念让网络结合实例分割自主学习出需要学习的区域。由于过强的语义信息导致受到监督的网络对于遮挡过于敏感，所以我们需要一些非直接的，可学习的方法来解决这个问题。本方法希望使用了弱监督的注意力来约束多人姿态的估计结果，从而达到改善原有多人姿态估计中出现的遮挡问题。

总体而言，本文的贡献主要有：
\begin{itemize}
	\item 简化网络结构，减少网络冗余的计算开销。
	\item 提出一种可以融合人体实例分割的姿态估计网络结构。
\end{itemize}

\section{本章小结}
\label{sec:introconclusion}
多人姿态估计在实际场景中拥有很高的应用价值。基于深度学习的方法已经被证明可以获得比传统方法更好的效果，但是在这些使用深度卷积神经网络的多人姿态估计方法中，仍存在一定的问题。本文目标是希望结合自顶向下与自底向上结构中各自的优势，在保证算法准确度损失最小的情况下，简化网络结构，减少其计算开销；并且使用一种可以融合实例分割的网络结构，改善现有姿态网络中在遮挡问题的应对能力。