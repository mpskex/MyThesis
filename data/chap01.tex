\chapter{绪 论}
\label{cha:intro}

% 课题引言
本章首先介绍课题的研究背景及意义，阐述了现有人体姿态提取的研究方向。之后本章介绍了近年基于单目图像的多人姿态估计方法的相关工作以及它们各自存在的问题。在此基础上，本章提出了本文的研究内容以及创新点。在本章最后，给出了本文整体结构。

\section{研究背景和意义}
\label{sec:generalbackground}
人体姿态提取旨在从传感器数据中提取多人姿态信息。近年来，人体姿态估计不仅在工业环境应用广泛，在商业上也有相当广阔的应用前景。在自动驾驶中，对行人的姿态准确检测与跟踪能够降低自动驾驶车辆与行人发生碰撞的可能性；在医疗康复中，姿态信息可以帮助医疗机构监督病人状态，以及时发现患者的异常状态；在运动训练中，姿态估计可以被用于动作矫正系统，用来监督运动员的姿态标准性从而保证训练的有效性；在安防方面，行人姿态检测与跟踪有助于追踪与分析犯罪嫌疑人的行为特征；在商业娱乐方面，姿态信息提取技术也是人机交互的重要手段。因此，寻找一个高性能、适用性强的姿态提取方法在计算机视觉领域是一个近年来学界一直关注的焦点方向。

现有多人姿态信息提取方法可以根据其分析的数据来源分为基于传感器的姿态提取方法与基于数字图像的姿态提取方法。基于传感器的姿态采集与追踪设备已经相当成熟，例如一些商用光学动作捕捉系统。然而几乎所有使用传感器的姿态捕捉方法都需要多个采集设备，例如多台标定好的高帧率红外摄像机或者是一台集成深度相机。由于这类方法一般都要求被采集者身上的光学追踪点进行定位，使得它们仅能被应用在一些封闭的场景中。相比之下，基于数字图像的多人姿态估计方法，可应用的场景更加广泛，成本相对更低。首先，基于数字图像姿态信息的输入仅需一张或一组标准数字图像，使得多人姿态信息的捕捉场景从封闭场景拓展到了更加开放的环境。同时，通用图像采集设备的的成本普遍比光学追踪系统更低，比如任何一台带有摄像头的移动设备，或是一台连接至远程计算中心的网络摄像头等等。即使在包含多人姿态估计所需的计算设备成本的前提下，基于数字图像的多人姿态估计方法的成本也低于光学追踪系统的开销。因此，基于数字图像的多人姿态提取方法相比基于传感器数据的姿态提取方法拥有更高的研究价值。

然而现有基于数字图像的多人姿态估计方法也面临一些技术难点，其中最难以解决的问题是互遮挡场景中的多人姿态估计。多人姿态估计任务希望算法即使在不同个体的躯干互相遮挡的情况下，仍应有能力给出被遮挡部位的位置估计，并给出正确的标签以将该关键点划分给对应的目标。举例来说，当一个人遮住另一个人的肩部时，算法应该给出被遮挡人的肩部位置，并将这个肩部位置注册至被遮挡人的姿态骨架上。这就需要算法能够根据可视部分的信息推断不可见部分的信息，从而补全对应位置的姿态信息。与自遮挡场景不同，姿态信息的结构先验无法帮助姿态估计方法根据自身可见关键点信息预测遮挡关键点的位置。现有的多人姿态估计方法在尝试解决互遮挡时仍存在缺陷，因此本文的研究方向主要是希望解决现有多人姿态估计方法中在互遮挡情况下姿态提取不准确的问题。

\section{相关研究工作}
\label{sec:related_work}
基于数字图像的多人姿态估计方法可以分为自顶向下与自底向上两种类型。自顶向下的多人姿态估计方法的主要特点就是在得到人体目标位置的前提下去预测人体姿态；而自底向上方法特点就是先完整的预测人体姿态，再将零散的姿态信息根据特征或其他的表达重组，建立独立完整的人体姿态。

\subsection{自顶向下的多人姿态估计方法}
\label{subsec:topdown}
目前常见的多人姿态估计方法主要都是使用自顶向下的格局设计网络的。算法会先提取人体位置，接下来经过裁剪以后送入姿态估计网络中得到姿态估计。这样的方法可以借助于高性能的单人姿态估计网络和人体检测网络来快速获得满意的效果。然而同时这种特性会带来误差传播的问题：检测结果的误差被传播如姿态估计阶段，导致自顶向下的方法普遍对于准确的目标检测结果依赖很高。近年改善自顶向下的多人姿态估计方法的工作中，Fang等提出的区域多人姿态估计方法\cite{fang2017rmpe}(RMPE)改善了以往自顶向下方法中目标检测不精确结果对于姿态估计的负面影响，通过设计简单的对称的空间变换网络\footnote{对称的空间变换网络，Symmetric Spatial Transformation Network，简称SSTN}依据人体姿态检测结果训练空间变换的参数。该方法一定程度上改善了误差传播问题，但空间变换网络输出仍然会限制空间变换的范围。如果初始检测结果无法得到人的位置，或者偏差过于严重，仍然会导致最后姿态估计的失败。同样地，虽然Chen等的方法\cite{Chen2017Cascaded}也使用了自顶向下的设计，但是该工作仅通过一个更加准确的检测器解决误差传播的问题，并没有通过结合检测与姿态估计任务来改善最终结果。综上所述，现有方法仍没有对误差传播这个问题提出很好的策略来解决不精确检测结果对于姿态估计的影响。

\subsection{自底向上的多人姿态估计方法}
\label{subsec:bottomup}
在使用自底向上结构设计的方法中，同样存在一些结构设计带来的问题。由于该类型方法需要一次性检测所有的关键点，再对这些关键点进行重组。因此，会存在一些在关键点检测阶段中出现的错误位置，被划分进入姿态骨架中。这些被错误检测到的结果可能是非关键点，或是一些不足以构建成为骨架的孤立关键点。同时，与自顶向下仅需要在被提取的兴趣区域上提取关键点不同，自底向上结构需要在完整图像上寻找所有可能的关键点，这对于使用卷积神经网络生成稠密概率图提取姿态的方法而言，会明显增加计算量。近年来的自底向上方法可以按照重组关键点的方法分为两类：使用向量场的与使用分割划分的两种方法。Cao等的工作\cite{Cao2016Realtime}在之前CPM工作的基础上，额外增加一个并行的、堆叠多层大卷积核的分支用来回归部件向量场(PAF, Part Affinity Field)。这个经过多阶段回归的向量场被用来连接不同关键点。每一个关系使用一对稠密向量场来描述对应的热图上每个位置的向量方向。该方法在稠密张量上求解向量与额外的网络分支会增加过多的计算量。并且在使用向量场恢复关键点连接时，算法可能会在一对来自不同人的相同躯干遮挡的情况下，给出错误的连接结果。

另外在使用划分的自底向上多人姿态估计方法中，Newell等的工作\cite{Newell2017Associative}又提出一种新的自底向上的多人姿态估计方法。文章中使用关联编码(Associative Embedding)来让网络自身学习对关键点进行类别标注。然而这种使用网络内部编码的方式定义的标签可解释不强，并且也并不能很精细地区分人与人之间的分割。除此之外，在Gong等的工作中\cite{gong2018instance}，提出了可以用于自底向上方法的实例部件分割，结合语意分割与边缘检测来划分人体。在上篇工作的基础上，Liang等使用一种基于精细的部件分割的人体划分方法\cite{liang2019look}。这种方法严格考虑了人体的精细结构，然而精细部件分割的数据标注需要比实例分割标注更多的时间。这就意味着完成该方法所提出的监督方式是需要更多的成本的。这对于一些庞大的数据集而言是很难实现的。

\section{研究内容及创新点}
\label{sec:contribution}
本文提出一种全新的融合人体实例分割信息的联合优化网络结构。该结构将实例分割信息加入到多阶段的联合优化网络设计中，同时优化分割结果与姿态估计结果。实例分割结果可以帮助改善互遮挡场景下的多人姿态结果，并且姿态估计也能够可以使实例分割依照关键点结构补全人体区域。

为了使实例分割的信息更加显著地影响姿态估计结果，本文引入了注意力机制的概念，即让网络自身生成权重选择其感兴趣区域的特征。这些被选择的特征被输入进后续结构中给出最终的姿态估计与实例分割结果。注意力机制的引入能够让网络更加明显地关注一些包含更多线索的区域。虽然实例分割能够帮助网络生成注意力，但在其真值中，被其他个体遮挡的区域并未被纳入实例分割信息的标注中。这导致现有实例分割的标注信息无法满足本文希望注意力达成目标的，即克服同类目标的互遮挡问题。所以本文提出一种特殊的监督方法让来自实例分割与姿态估计的监督信息宽松地约束空间注意力的生成。

在监督注意力的过程中，本文使用弱监督的思想来监督网络生成适当的注意力。如果使用过强的、不完整的标注信息监督注意力，那么如此约束下的注意力一定会对于遮挡过于敏感。弱监督学习是是指在强监督信息不完整或不准确的情况下，使用较宽松的监督信息或结构约束并训练网络的方法\cite{10.1093/nsr/nwx106}。弱监督学习的出现让网络对于监督信息的质量要求变得更加宽松，使神经网络在不稳定的、不完整的标注信息训练下仍然有能力完成被设计的功能。所以，本文希望通过弱监督学习在不考虑遮挡的分割标注信息下学习考虑遮挡的注意力，从而达到多人姿态估计中划分不同人体目标的目的。

总体而言，本文的贡献主要有：
\begin{itemize}
	\item 提出一种全新的融合人体实例分割的联合网络结构，使用由实例分割生成的空间注意力帮助改善多人姿态估计结果，同时借助关键点检测补全分割预测中缺失的部分；
	\item 使用注意力机制在特征层面对关键点结果进行划分，让网络根据监督信息自主生成所需要的关注区域，对人体姿态在实例层面上进行姿态估计；
	\item 提出了一种宽松的监督方式让网络生成对应的空间注意力，以改善分割信息对不可见身体部分的监督缺失，让空间注意力能够对遮挡区域做出响应。
\end{itemize}

\section{文章结构}
\label{sec:introconclusion}
本文在第二章简要介绍了多人姿态估计相关技术，包括基于深度卷积神经网络的特征提取、基于深度学习的目标检测以及基于深度学习的人体姿态估计技术。本文在第三章描述所提出的网络框架。第四章中本文设计了对应的消融实验以及在COCO 2017数据集上的性能测试以验证本文提出结构的有效性。最终，文章给出了对该工作的总结与展望。